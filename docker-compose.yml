version: "3"

services:
  mongo:
    image: mongo
  common:
    image: l2py-common
    build:
      dockerfile: ./common/Dockerfile
      context: .
  data:
    build:
      dockerfile: ./data/Dockerfile
      context: .
    restart: always
    environment:
      MONGO_URI: mongo

  login:
    build:
      dockerfile: ./login/Dockerfile
      context: .
    restart: always
    environment:
      DATA_SERVER_HOST: data
    ports:
      - "2106:2106"

  game:
    build:
      dockerfile: ./game/Dockerfile
      context: .
    restart: always
    environment:
      DATA_SERVER_HOST: data
      LOGIN_SERVER_API_HOST: login
    ports:
      - "7777:7777"
